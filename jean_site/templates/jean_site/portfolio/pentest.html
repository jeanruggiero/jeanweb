{% extends "jean_site/portfolio/base_portfolio.html" %}
{% block title %}Jean Ruggiero - Portfolio: PenTesting an IoT device{% endblock %}
{% block header_large %}smart switch pentest{% endblock %}
{% block header_small %}security assessment of an IoT device{% endblock %}

{% block content %}
{% load static %}

<h3>The System</h3>
<p class="portfolio">As part of a cybersecurity class project, I performed a security assessment and penTest of a WiFi smart switch IoT device. The
    smart switch is an Internet of Things (IoT) device that can be controlled by the accompanying phone app, either within or outside of the Wi-Fi
    network. The basic hardware
    consists of a relay
    controlled by an Espressif Systems ESP8266 microcontroller. Hacking an IoT device was challenging - the wide array of platforms, devices, and
    protocols results in fewer open source tools and exploit payloads for a specific device. See below for a summary of my assessment.
</p>

<h3>Attackers & Risks</h3>

<p class="portfolio">
    The risks of an attack on the smart switch vary depending on the
assets in play and the motivation of the attacker.
If thw switch is used to control power to physical security mechanisms, an
attacker may wish to control these devices as part of a
robbery, act of espionage, or other similar crime.
If it's used to control power to hazardous equipment, damage of
property or harm to occupants could be possible.
An attacker may also be able to surveil users and gain
knowledge of their location, behavior, etc.
</p>

<h3>Types of Attacks</h3>
<p class="portfolio">
I attempted to mount each of the attacks outlined below on the smart switch.
</p>
<h4>Supply Chain Attack</h4>
<p class="portfolio">
In a supply chain attack, an attacker at some
point in the supply chain could easily flash
modified device firmware to smart switch devices.
Modifications may include injection of spyware
for eavesdropping purposes, or a backdoor
allowing remote access of the device.
Such an attack could be used at scale (e.g.
BotNet) or used to target individuals or corporations. I was able to successfully read the firmware off of the device by soldering wires to the
    UART interface but I was unable to modify the firmware because a disassembler (objdump) for the device's ELF format could not be obtained.
</p>

<div class="img c2-12">
    <img class="c2-12" src="{% static "images/pentest_supply_chain.png" %}"
     alt="Plan of attack and tools for supply chain attack against the WiFi smart switch.">
</div>

<h4>Device Memory Access</h4>
<p class="portfolio">
The device memory contains several items of interest
to an attacker, including RSA Keys, X509 certs, and the user's home Wi-Fi password. An attacker could use these to eavesdrop, control the
switch, and/or access the Wi-Fi network. I was able to find evidence that these secrets exist on the device's hard drive, but I was unable to
    obtain them as I could not find a disassembler to disassemble the ELF file containing the device firmware.
</p>

<div class="img c2-12">
    <img class="c2-12" src="{% static "images/pentest_device_memory_access.png" %}"
     alt="Plan of attack and tools for WiFi smart switch device memory access.">
</div>

<h4>Denial of Service Attack</h4>
<p class="portfolio">
An attacker may mount a denial of service (DoS) attack in an effort to prevent users from being able to
control devices connected to smart switches.
Such an attack could be used to disable devices controlled
by the switch (e.g. security lighting). This attack was mounted successfully; I was able to prevent the intended user from controlling the smart
    switch.
</p>

<div class="img c2-12">
    <img class="c2-12" src="{% static "images/pentest_dos.png" %}"
     alt="Plan of attack and tools for WiFi smart switch DoS attack.">
</div>

<h4>Replay Attack</h4>
<p class="portfolio">
An attacker can attempt to control the smart switch state
by recording network traffic and isolating a message that
turns the device “on” or “off”.
The attacker can try to turn the device on or off by
replaying the corresponding message over the network. This attack was unsuccessful, most likely because the device checks incoming requests for
    freshness.
</p>

<div class="img c2-12">
    <img class="c2-12" src="{% static "images/pentest_replay.png" %}"
     alt="Plan of attack and tools for WiFi smart switch replay attack.">
</div>

{% endblock content %}